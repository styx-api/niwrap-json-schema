{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "description": "Fits a polynomial in space to the input dataset and outputs that fitted dataset. You can also add your own basis datasets to the fitting mix.",
  "type": "object",
  "properties": {
    "@type": {
      "const": "afni.3dPolyfit"
    },
    "input_dataset": {
      "type": "string",
      "title": "Input dataset",
      "description": "Input dataset (e.g., data.nii.gz)"
    },
    "poly_order": {
      "anyOf": [
        {
          "type": "integer",
          "minimum": -1,
          "maximum": 9
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Polynomial order",
      "description": "Maximum polynomial order (0..9); [default=3]; [n=0 is the constant 1]; [n=-1 means only use volumes from '-base']"
    },
    "blur": {
      "anyOf": [
        {
          "type": "number"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Blur FWHM",
      "description": "Gaussian blur input dataset (inside mask) with FWHM='f' (mm)"
    },
    "median_radius": {
      "anyOf": [
        {
          "type": "number"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Median filter radius",
      "description": "Radius (voxels) of preliminary median filter of input; default is no blurring"
    },
    "output_prefix": {
      "anyOf": [
        {
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Output prefix",
      "description": "Use 'pp' for prefix of output dataset (the fit); default prefix is 'Polyfit'; use NULL to skip this output"
    },
    "resid_prefix": {
      "anyOf": [
        {
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Residual prefix",
      "description": "Use 'rr' for the prefix of the residual dataset; default is not to output residuals"
    },
    "coeff_output": {
      "anyOf": [
        {
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Coefficient output",
      "description": "Save coefficients of fit into text file cc.1D; default is not to save these coefficients"
    },
    "automask": {
      "type": "boolean",
      "default": false,
      "title": "Automask flag",
      "description": "Create a mask (a la 3dAutomask)"
    },
    "mask_dataset": {
      "anyOf": [
        {
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Mask dataset",
      "description": "Create a mask from nonzero voxels in 'mset'; default is not to use a mask"
    },
    "mean_scale": {
      "type": "boolean",
      "default": false,
      "title": "Mean scale flag",
      "description": "Scale the mean value of the fit (inside the mask) to 1; probably this option is not useful for anything"
    },
    "clip_box": {
      "type": "boolean",
      "default": false,
      "title": "Clip box flag",
      "description": "Clip fit values outside the rectilinear box containing the mask to the edge of that box, to avoid weird artifacts"
    },
    "fit_method": {
      "anyOf": [
        {
          "type": "integer",
          "minimum": 1,
          "maximum": 2
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Fit method",
      "description": "Set 'mm' to 2 for least squares fit; set it to 1 for L1 fit [default method=2]; [Note that L1 fitting is slower than L2 fitting]"
    },
    "base_dataset": {
      "anyOf": [
        {
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Base dataset",
      "description": "In addition to the polynomial fit, also use the volumes in dataset 'bb' as extra basis functions"
    },
    "verbose": {
      "type": "boolean",
      "default": false,
      "title": "Verbose flag",
      "description": "Print fun and useful progress reports"
    }
  },
  "additionalProperties": false,
  "required": [
    "input_dataset"
  ]
}