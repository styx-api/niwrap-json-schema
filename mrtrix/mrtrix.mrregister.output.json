{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "mrregister",
  "description": "Register two images together using a symmetric rigid, affine or non-linear transformation model.\n\nBy default this application will perform an affine, followed by non-linear registration.\n\nFOD registration (with apodised point spread reorientation) will be performed by default if the number of volumes in the 4th dimension equals the number of coefficients in an antipodally symmetric spherical harmonic series (e.g. 6, 15, 28 etc). The -no_reorientation option can be used to force reorientation off if required.\n\nNon-linear registration computes warps to map from both image1->image2 and image2->image1. Similar to Avants (2008) Med Image Anal. 12(1): 26\u00e2\u20ac\u201c41, registration is performed by matching both the image1 and image2 in a 'midway space'. Warps can be saved as two deformation fields that map directly between image1->image2 and image2->image1, or if using -nl_warp_full as a single 5D file that stores all 4 warps image1->mid->image2, and image2->mid->image1. The 5D warp format stores x,y,z deformations in the 4th dimension, and uses the 5th dimension to index the 4 warps. The affine transforms estimated (to midway space) are also stored as comments in the image header. The 5D warp file can be used to reinitialise subsequent registrations, in addition to transforming images to midway space (e.g. for intra-subject alignment in a 2-time-point longitudinal analysis).\n\nReferences:\n\n* If FOD registration is being performed:\nRaffelt, D.; Tournier, J.-D.; Fripp, J; Crozier, S.; Connelly, A. & Salvado, O. Symmetric diffeomorphic registration of fibre orientation distributions. NeuroImage, 2011, 56(3), 1171-1180\n\nRaffelt, D.; Tournier, J.-D.; Crozier, S.; Connelly, A. & Salvado, O. Reorientation of fiber orientation distributions using apodized point spread functions. Magnetic Resonance in Medicine, 2012, 67, 844-855",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "root": {
      "type": "string",
      "title": "Root",
      "description": "Output root directory"
    },
    "rigid": {
      "type": "string",
      "title": "rigid",
      "description": "the output text file containing the rigid transformation as a 4x4 matrix "
    },
    "rigid_1tomidway": {
      "type": "string",
      "title": "rigid_1tomidway",
      "description": "the output text file containing the rigid transformation that aligns image1 to image2 in their common midway space as a 4x4 matrix "
    },
    "rigid_2tomidway": {
      "type": "string",
      "title": "rigid_2tomidway",
      "description": "the output text file containing the rigid transformation that aligns image2 to image1 in their common midway space as a 4x4 matrix "
    },
    "rigid_log": {
      "type": "string",
      "title": "rigid_log",
      "description": "write gradient descent parameter evolution to log file "
    },
    "affine": {
      "type": "string",
      "title": "affine",
      "description": "the output text file containing the affine transformation as a 4x4 matrix "
    },
    "affine_1tomidway": {
      "type": "string",
      "title": "affine_1tomidway",
      "description": "the output text file containing the affine transformation that aligns image1 to image2 in their common midway space as a 4x4 matrix "
    },
    "affine_2tomidway": {
      "type": "string",
      "title": "affine_2tomidway",
      "description": "the output text file containing the affine transformation that aligns image2 to image1 in their common midway space as a 4x4 matrix "
    },
    "affine_log": {
      "type": "string",
      "title": "affine_log",
      "description": "write gradient descent parameter evolution to log file "
    },
    "nl_warp_full": {
      "type": "string",
      "title": "nl_warp_full",
      "description": "output all warps used during registration. This saves four different warps that map each image to a midway space and their inverses in a single 5D image file. The 4th image dimension indexes the x,y,z component of the deformation vector and the 5th dimension indexes the field in this order: image1->midway, midway->image1, image2->midway, midway->image2. Where image1->midway defines the field that maps image1 onto the midway space using the reverse convention When linear registration is performed first, the estimated linear transform will be included in the comments of the image header, and therefore the entire linear and non-linear transform can be applied (in either direction) using this output warp file with mrtransform "
    },
    "mrregister": {
      "anyOf": [
        {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "root": {
              "type": "string",
              "title": "Root",
              "description": "Output root directory"
            },
            "warp1": {
              "type": "string",
              "title": "warp1",
              "description": "the non-linear warp output defined as two deformation fields, where warp1 can be used to transform image1->image2 and warp2 to transform image2->image1. The deformation fields also encapsulate any linear transformation estimated prior to non-linear registration."
            },
            "warp2": {
              "type": "string",
              "title": "warp2",
              "description": "the non-linear warp output defined as two deformation fields, where warp1 can be used to transform image1->image2 and warp2 to transform image2->image1. The deformation fields also encapsulate any linear transformation estimated prior to non-linear registration."
            }
          }
        },
        {
          "type": "null"
        }
      ]
    }
  }
}