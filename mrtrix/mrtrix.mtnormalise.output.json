{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "mtnormalise",
  "description": "Multi-tissue informed log-domain intensity normalisation.\n\nThis command takes as input any number of tissue components (e.g. from multi-tissue CSD) and outputs corresponding normalised tissue components corrected for the effects of (residual) intensity inhomogeneities. Intensity normalisation is performed by optimising the voxel-wise sum of all tissue compartments towards a constant value, under constraints of spatial smoothness (polynomial basis of a given order). Different to the Raffelt et al. 2017 abstract, this algorithm performs this task in the log-domain instead, with added gradual outlier rejection, different handling of the balancing factors between tissue compartments and a different iteration structure.\n\nThe -mask option is mandatory and is optimally provided with a brain mask (such as the one obtained from dwi2mask earlier in the processing pipeline). Outlier areas with exceptionally low or high combined tissue contributions are accounted for and reoptimised as the intensity inhomogeneity estimation becomes more accurate.\n\nReferences:\n\nRaffelt, D.; Dhollander, T.; Tournier, J.-D.; Tabbara, R.; Smith, R. E.; Pierre, E. & Connelly, A. Bias Field Correction and Intensity Normalisation for Quantitative Analysis of Apparent Fibre Density. In Proc. ISMRM, 2017, 26, 3541\n\nDhollander, T.; Tabbara, R.; Rosnarho-Tornstrand, J.; Tournier, J.-D.; Raffelt, D. & Connelly, A. Multi-tissue log-domain intensity and inhomogeneity normalisation for quantitative apparent fibre density. In Proc. ISMRM, 2021, 29, 2472",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "root": {
      "type": "string",
      "title": "Root",
      "description": "Output root directory"
    },
    "check_norm": {
      "type": "string",
      "title": "check_norm",
      "description": "output the final estimated spatially varying intensity level that is used for normalisation. "
    },
    "check_mask": {
      "type": "string",
      "title": "check_mask",
      "description": "output the final mask used to compute the normalisation. This mask excludes regions identified as outliers by the optimisation process. "
    },
    "check_factors": {
      "type": "string",
      "title": "check_factors",
      "description": "output the tissue balance factors computed during normalisation. "
    },
    "mtnormalise": {
      "type": "array",
      "items": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "root": {
            "type": "string",
            "title": "Root",
            "description": "Output root directory"
          },
          "output": {
            "type": "string",
            "title": "output",
            "description": "output normalised tissue compartment image."
          }
        }
      }
    }
  }
}