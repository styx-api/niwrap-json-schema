{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "antsAI",
  "description": "Program to calculate the optimal linear transform parameters for aligning two images.",
  "type": "object",
  "properties": {
    "@type": {
      "const": "ants/antsAI"
    },
    "dimensionality": {
      "anyOf": [
        {
          "type": "integer",
          "enum": [
            2,
            3
          ]
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Dimensionality",
      "description": "This option forces the image to be treated as a specified-dimensional image. If not specified, we try to infer the dimensionality from the input image."
    },
    "metric": {
      "anyOf": [
        {
          "type": "object",
          "properties": {
            "@type": {
              "const": "metric_mattes"
            },
            "fixed_image": {
              "type": "string",
              "x-styx-type": "file",
              "title": "Fixed image"
            },
            "moving_image": {
              "type": "string",
              "x-styx-type": "file",
              "title": "Moving image"
            },
            "number_of_bins": {
              "anyOf": [
                {
                  "type": "object",
                  "properties": {
                    "@type": {
                      "const": "number_of_bins"
                    },
                    "number_of_bins_value": {
                      "type": "integer",
                      "title": "Number of bins"
                    },
                    "sampling_strategy": {
                      "anyOf": [
                        {
                          "type": "object",
                          "properties": {
                            "@type": {
                              "const": "sampling_strategy"
                            },
                            "sampling_strategy_value": {
                              "type": "string",
                              "enum": [
                                "None",
                                "Regular",
                                "Random"
                              ],
                              "title": "Sampling strategy"
                            },
                            "sampling_percentage": {
                              "anyOf": [
                                {
                                  "type": "object",
                                  "properties": {
                                    "@type": {
                                      "const": "sampling_percentage"
                                    },
                                    "sampling_percentage_value": {
                                      "type": "number",
                                      "minimum": 0,
                                      "maximum": 1,
                                      "title": "Sampling percentage"
                                    }
                                  },
                                  "additionalProperties": false,
                                  "required": [
                                    "sampling_percentage_value"
                                  ]
                                },
                                {
                                  "type": "null"
                                }
                              ],
                              "default": null
                            }
                          },
                          "additionalProperties": false,
                          "required": [
                            "sampling_strategy_value"
                          ]
                        },
                        {
                          "type": "null"
                        }
                      ],
                      "default": null
                    }
                  },
                  "additionalProperties": false,
                  "required": [
                    "number_of_bins_value"
                  ]
                },
                {
                  "type": "null"
                }
              ],
              "default": null
            }
          },
          "additionalProperties": false,
          "title": "Mattes mutual information",
          "required": [
            "@type",
            "fixed_image",
            "moving_image"
          ]
        },
        {
          "type": "object",
          "properties": {
            "@type": {
              "const": "metric_gc"
            },
            "fixed_image": {
              "type": "string",
              "x-styx-type": "file",
              "title": "Fixed image"
            },
            "moving_image": {
              "type": "string",
              "x-styx-type": "file",
              "title": "Moving image"
            },
            "radius": {
              "anyOf": [
                {
                  "type": "object",
                  "properties": {
                    "@type": {
                      "const": "radius"
                    },
                    "radius_value": {
                      "type": "number",
                      "title": "Radius"
                    },
                    "sampling_strategy": {
                      "anyOf": [
                        {
                          "type": "object",
                          "properties": {
                            "@type": {
                              "const": "sampling_strategy_1"
                            },
                            "sampling_strategy_value": {
                              "type": "string",
                              "enum": [
                                "None",
                                "Regular",
                                "Random"
                              ],
                              "title": "Sampling strategy"
                            },
                            "sampling_percentage": {
                              "anyOf": [
                                {
                                  "type": "object",
                                  "properties": {
                                    "@type": {
                                      "const": "sampling_percentage_1"
                                    },
                                    "sampling_percentage_value": {
                                      "type": "number",
                                      "minimum": 0,
                                      "maximum": 1,
                                      "title": "Sampling percentage"
                                    }
                                  },
                                  "additionalProperties": false,
                                  "required": [
                                    "sampling_percentage_value"
                                  ]
                                },
                                {
                                  "type": "null"
                                }
                              ],
                              "default": null
                            }
                          },
                          "additionalProperties": false,
                          "required": [
                            "sampling_strategy_value"
                          ]
                        },
                        {
                          "type": "null"
                        }
                      ],
                      "default": null
                    }
                  },
                  "additionalProperties": false,
                  "required": [
                    "radius_value"
                  ]
                },
                {
                  "type": "null"
                }
              ],
              "default": null
            }
          },
          "additionalProperties": false,
          "title": "Global correlation",
          "required": [
            "@type",
            "fixed_image",
            "moving_image"
          ]
        },
        {
          "type": "object",
          "properties": {
            "@type": {
              "const": "metric_mi"
            },
            "fixed_image": {
              "type": "string",
              "x-styx-type": "file",
              "title": "Fixed image"
            },
            "moving_image": {
              "type": "string",
              "x-styx-type": "file",
              "title": "Moving image"
            },
            "number_of_bins": {
              "anyOf": [
                {
                  "type": "object",
                  "properties": {
                    "@type": {
                      "const": "number_of_bins_1"
                    },
                    "number_of_bins_value": {
                      "type": "integer",
                      "title": "Number of bins"
                    },
                    "sampling_strategy": {
                      "anyOf": [
                        {
                          "type": "object",
                          "properties": {
                            "@type": {
                              "const": "sampling_strategy_2"
                            },
                            "sampling_strategy_value": {
                              "type": "string",
                              "enum": [
                                "None",
                                "Regular",
                                "Random"
                              ],
                              "title": "Sampling strategy"
                            },
                            "sampling_percentage": {
                              "anyOf": [
                                {
                                  "type": "object",
                                  "properties": {
                                    "@type": {
                                      "const": "sampling_percentage_2"
                                    },
                                    "sampling_percentage_value": {
                                      "type": "number",
                                      "minimum": 0,
                                      "maximum": 1,
                                      "title": "Sampling percentage"
                                    }
                                  },
                                  "additionalProperties": false,
                                  "required": [
                                    "sampling_percentage_value"
                                  ]
                                },
                                {
                                  "type": "null"
                                }
                              ],
                              "default": null
                            }
                          },
                          "additionalProperties": false,
                          "required": [
                            "sampling_strategy_value"
                          ]
                        },
                        {
                          "type": "null"
                        }
                      ],
                      "default": null
                    }
                  },
                  "additionalProperties": false,
                  "required": [
                    "number_of_bins_value"
                  ]
                },
                {
                  "type": "null"
                }
              ],
              "default": null
            }
          },
          "additionalProperties": false,
          "title": "Joint histogram mutual information",
          "required": [
            "@type",
            "fixed_image",
            "moving_image"
          ]
        }
      ],
      "title": "Metric",
      "description": "Image similarity metric. Available metrics: Mattes (Mattes mutual information, recommended), GC (global correlation), MI (joint histogram mutual information). Each metric takes a fixed and moving image, with optional sampling parameters."
    },
    "transform": {
      "anyOf": [
        {
          "type": "object",
          "properties": {
            "@type": {
              "const": "transform_rigid"
            },
            "gradient_step": {
              "type": "number",
              "title": "Gradient step"
            }
          },
          "additionalProperties": false,
          "title": "Rigid",
          "required": [
            "@type",
            "gradient_step"
          ]
        },
        {
          "type": "object",
          "properties": {
            "@type": {
              "const": "transform_affine"
            },
            "gradient_step": {
              "type": "number",
              "title": "Gradient step"
            }
          },
          "additionalProperties": false,
          "title": "Affine",
          "required": [
            "@type",
            "gradient_step"
          ]
        },
        {
          "type": "object",
          "properties": {
            "@type": {
              "const": "transform_similarity"
            },
            "gradient_step": {
              "type": "number",
              "title": "Gradient step"
            }
          },
          "additionalProperties": false,
          "title": "Similarity",
          "required": [
            "@type",
            "gradient_step"
          ]
        },
        {
          "type": "object",
          "properties": {
            "@type": {
              "const": "transform_align_geometric_centers"
            }
          },
          "additionalProperties": false,
          "title": "Align geometric centers",
          "required": [
            "@type"
          ]
        },
        {
          "type": "object",
          "properties": {
            "@type": {
              "const": "transform_align_centers_of_mass"
            }
          },
          "additionalProperties": false,
          "title": "Align centers of mass",
          "required": [
            "@type"
          ]
        }
      ],
      "title": "Transform",
      "description": "Transform type for alignment. The rigid, affine, and similarity transforms take a gradient step parameter that characterizes the gradient descent optimization and is scaled appropriately for each transform using the shift scales estimator. AlignGeometricCenters and AlignCentersOfMass find the simple translation transform aligning the specified image feature. Note that the images are read from the metric option although the metric value itself is not used for the latter two."
    },
    "align_principal_axes": {
      "anyOf": [
        {
          "type": "boolean"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Align principal axes",
      "description": "Align images by their principal axes. Alternatively, one can align using blobs (see --align-blobs option)."
    },
    "align_blobs": {
      "anyOf": [
        {
          "type": "object",
          "properties": {
            "@type": {
              "const": "align_blobs"
            },
            "number_of_blobs_to_extract": {
              "type": "integer",
              "title": "Number of blobs to extract"
            },
            "number_of_blobs_to_match": {
              "anyOf": [
                {
                  "type": "object",
                  "properties": {
                    "@type": {
                      "const": "number_of_blobs_to_match"
                    },
                    "number_of_blobs_to_match_value": {
                      "type": "integer",
                      "title": "Number of blobs to match"
                    }
                  },
                  "additionalProperties": false,
                  "required": [
                    "number_of_blobs_to_match_value"
                  ]
                },
                {
                  "type": "null"
                }
              ],
              "default": null
            }
          },
          "additionalProperties": false,
          "description": "Align images using a set of extracted blobs. Specify the number of blobs to extract, and optionally the number of blobs to match (defaults to numberOfBlobsToExtract). Alternatively, one can align using principal axes (see --align-principal-axes option).",
          "required": [
            "number_of_blobs_to_extract"
          ]
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "description": "Align images using a set of extracted blobs. Specify the number of blobs to extract, and optionally the number of blobs to match (defaults to numberOfBlobsToExtract). Alternatively, one can align using principal axes (see --align-principal-axes option)."
    },
    "search_factor": {
      "anyOf": [
        {
          "type": "object",
          "properties": {
            "@type": {
              "const": "search_factor"
            },
            "search_factor_value": {
              "type": "number",
              "title": "Search factor"
            },
            "arc_fraction": {
              "anyOf": [
                {
                  "type": "object",
                  "properties": {
                    "@type": {
                      "const": "arc_fraction"
                    },
                    "arc_fraction_value": {
                      "type": "number",
                      "title": "Arc fraction"
                    }
                  },
                  "additionalProperties": false,
                  "required": [
                    "arc_fraction_value"
                  ]
                },
                {
                  "type": "null"
                }
              ],
              "default": null
            }
          },
          "additionalProperties": false,
          "description": "Incremental search factor (in degrees) which will sample the arc fraction around the principal axis or default axis. Default search factor is 20 degrees with an arc fraction of 1.0.",
          "required": [
            "search_factor_value"
          ]
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "description": "Incremental search factor (in degrees) which will sample the arc fraction around the principal axis or default axis. Default search factor is 20 degrees with an arc fraction of 1.0."
    },
    "translation_search_grid": {
      "anyOf": [
        {
          "type": "object",
          "properties": {
            "@type": {
              "const": "translation_search_grid"
            },
            "step_size": {
              "type": "number",
              "title": "Step size",
              "description": "Translation step size in mm. Default is 25."
            },
            "grid": {
              "type": "array",
              "items": {
                "type": "integer"
              },
              "title": "Grid",
              "description": "Translation search grid extent in each dimension, specified as AxBxC. Default is 0x0x0."
            }
          },
          "additionalProperties": false,
          "description": "Translation search grid in mm, which will translate the moving image in each dimension in increments of the step size.",
          "required": [
            "step_size",
            "grid"
          ]
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "description": "Translation search grid in mm, which will translate the moving image in each dimension in increments of the step size."
    },
    "convergence": {
      "anyOf": [
        {
          "type": "object",
          "properties": {
            "@type": {
              "const": "convergence"
            },
            "number_of_iterations": {
              "type": "integer",
              "title": "Number of iterations"
            },
            "convergence_threshold": {
              "anyOf": [
                {
                  "type": "object",
                  "properties": {
                    "@type": {
                      "const": "convergence_threshold"
                    },
                    "convergence_threshold_value": {
                      "type": "number",
                      "title": "Convergence threshold"
                    },
                    "convergence_window_size": {
                      "anyOf": [
                        {
                          "type": "object",
                          "properties": {
                            "@type": {
                              "const": "convergence_window_size"
                            },
                            "convergence_window_size_value": {
                              "type": "integer",
                              "title": "Convergence window size"
                            }
                          },
                          "additionalProperties": false,
                          "required": [
                            "convergence_window_size_value"
                          ]
                        },
                        {
                          "type": "null"
                        }
                      ],
                      "default": null
                    }
                  },
                  "additionalProperties": false,
                  "required": [
                    "convergence_threshold_value"
                  ]
                },
                {
                  "type": "null"
                }
              ],
              "default": null
            }
          },
          "additionalProperties": false,
          "description": "Convergence parameters for the optimization. Specify the number of iterations, and optionally a convergence threshold (default 1e-6) and convergence window size (default 10).",
          "required": [
            "number_of_iterations"
          ]
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "description": "Convergence parameters for the optimization. Specify the number of iterations, and optionally a convergence threshold (default 1e-6) and convergence window size (default 10)."
    },
    "masks": {
      "anyOf": [
        {
          "type": "object",
          "properties": {
            "@type": {
              "const": "masks"
            },
            "fixed_image_mask": {
              "type": "string",
              "x-styx-type": "file",
              "title": "Fixed image mask"
            },
            "moving_image_mask": {
              "anyOf": [
                {
                  "type": "object",
                  "properties": {
                    "@type": {
                      "const": "moving_image_mask"
                    },
                    "moving_image_mask_value": {
                      "type": "string",
                      "x-styx-type": "file",
                      "title": "Moving image mask"
                    }
                  },
                  "additionalProperties": false,
                  "required": [
                    "moving_image_mask_value"
                  ]
                },
                {
                  "type": "null"
                }
              ],
              "default": null
            }
          },
          "additionalProperties": false,
          "description": "Image masks to limit the voxels considered by the metric. Specify a fixed image mask, and optionally a moving image mask.",
          "required": [
            "fixed_image_mask"
          ]
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "description": "Image masks to limit the voxels considered by the metric. Specify a fixed image mask, and optionally a moving image mask."
    },
    "output": {
      "type": "string",
      "title": "Output",
      "description": "Specify the output transform filename (output format is an ITK .mat file)."
    },
    "random_seed": {
      "anyOf": [
        {
          "type": "integer"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Random seed",
      "description": "Use a fixed seed for random number generation. The default fixed seed is overwritten by this value. The fixed seed can be any nonzero int value. If the specified seed is zero, the system time will be used."
    },
    "verbose": {
      "anyOf": [
        {
          "type": "boolean"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Verbose",
      "description": "Verbose output. Default is 0 (off)."
    }
  },
  "additionalProperties": false,
  "required": [
    "metric",
    "transform",
    "output",
    "@type"
  ]
}