{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "description": "Performs DTI reconstruction from the raw DWI input files.",
  "type": "object",
  "properties": {
    "@type": {
      "const": "freesurfer.dt_recon"
    },
    "input_volume": {
      "type": "string",
      "title": "Input Volume",
      "description": "Input volume (DWI data)."
    },
    "bvals_bvecs": {
      "anyOf": [
        {
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "B-values and B-vectors",
      "description": "B-values and B-vectors files."
    },
    "subject_id": {
      "type": "string",
      "title": "Subject ID",
      "description": "Subject ID."
    },
    "output_dir": {
      "type": "string",
      "title": "Output Directory",
      "description": "Output directory."
    },
    "info_dump": {
      "anyOf": [
        {
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Info Dump",
      "description": "Use info dump created by unpacksdcmdir or dcmunpack."
    },
    "ec_reference": {
      "anyOf": [
        {
          "type": "number"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "EC Reference Time Points",
      "description": "Use specified time points as 0-based reference for eddy current correction."
    },
    "no_ec_flag": {
      "type": "boolean",
      "default": false,
      "title": "No Eddy Correction Flag",
      "description": "Turn off eddy/motion correction."
    },
    "no_reg_flag": {
      "type": "boolean",
      "default": false,
      "title": "No Registration Flag",
      "description": "Do not register to subject or resample to talairach."
    },
    "register_file": {
      "anyOf": [
        {
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Register File",
      "description": "Supply a register.lta file instead of registering."
    },
    "no_tal_flag": {
      "type": "boolean",
      "default": false,
      "title": "No Talairach Flag",
      "description": "Do not resample FA to talairach space."
    },
    "subjects_dir": {
      "anyOf": [
        {
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Subjects Directory",
      "description": "Specify subjects directory (default env SUBJECTS_DIR)."
    },
    "save_ec_residuals_flag": {
      "type": "boolean",
      "default": false,
      "title": "Save EC Residuals Flag",
      "description": "Save residual error (dwires and eres)."
    },
    "pca_analysis_flag": {
      "type": "boolean",
      "default": false,
      "title": "PCA Analysis Flag",
      "description": "Run PCA/SVD analysis on eres (saves in pca-eres dir)."
    },
    "mask_prune_threshold": {
      "anyOf": [
        {
          "type": "number"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Mask Prune Threshold",
      "description": "Set threshold for masking (default is FLT_MIN)."
    },
    "init_spm_flag": {
      "type": "boolean",
      "default": false,
      "title": "Initialize with SPM Flag",
      "description": "Initialize BBR with SPM instead of coreg (requires MATLAB)."
    },
    "init_fsl_flag": {
      "type": "boolean",
      "default": false,
      "title": "Initialize with FSL Flag",
      "description": "Initialize BBR with FSL instead of coreg."
    },
    "debug_flag": {
      "type": "boolean",
      "default": false,
      "title": "Debug Flag",
      "description": "Print out lots of info."
    },
    "version_flag": {
      "type": "boolean",
      "default": false,
      "title": "Version Flag",
      "description": "Print version of this script and exit."
    }
  },
  "additionalProperties": false,
  "required": [
    "input_volume",
    "subject_id",
    "output_dir"
  ]
}