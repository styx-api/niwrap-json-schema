{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "description": "Minimally invasive defacing tool",
  "type": "object",
  "properties": {
    "@type": {
      "const": "freesurfer.mideface"
    },
    "input_volume": {
      "type": "string",
      "x-styx-type": "file",
      "title": "Input Volume",
      "description": "Volume to deface"
    },
    "output_volume": {
      "type": "string",
      "title": "Output Volume",
      "description": "Defaced output volume"
    },
    "facemask": {
      "anyOf": [
        {
          "type": "string",
          "x-styx-type": "file"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Facemask",
      "description": "Facemask to apply"
    },
    "output_dir": {
      "anyOf": [
        {
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Output Directory",
      "description": "Directory for outputs, activates PostHeadSurf"
    },
    "exclusion_mask": {
      "anyOf": [
        {
          "type": "string",
          "x-styx-type": "file"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Exclusion Mask",
      "description": "Mask to exclude certain regions from defacing"
    },
    "samseg_ndilations": {
      "anyOf": [
        {
          "type": "number"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Samseg Dilations",
      "description": "Number of dilations for Samseg segmentation"
    },
    "samseg_json": {
      "anyOf": [
        {
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Samseg JSON",
      "description": "JSON configuration for Samseg"
    },
    "samseg_fast": {
      "type": "boolean",
      "default": false,
      "title": "Samseg Fast",
      "description": "Configure Samseg to run quickly"
    },
    "no_samseg_fast": {
      "type": "boolean",
      "default": false,
      "title": "Do not run Samseg Fast",
      "description": "Do not configure Samseg to run quickly"
    },
    "init_reg": {
      "anyOf": [
        {
          "type": "string",
          "x-styx-type": "file"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Initial Registration",
      "description": "Initial registration file for Samseg"
    },
    "synthseg_ndilations": {
      "anyOf": [
        {
          "type": "number"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Synthseg Dilations",
      "description": "Number of dilations for Synthseg segmentation"
    },
    "fill_const": {
      "anyOf": [
        {
          "type": "array",
          "items": {
            "type": "number"
          },
          "minItems": 2,
          "maxItems": 2
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Fill Constants",
      "description": "Constants for filling regions"
    },
    "fill_zero": {
      "type": "boolean",
      "default": false,
      "title": "Fill Zero",
      "description": "Fill regions with zero"
    },
    "fhi": {
      "anyOf": [
        {
          "type": "number"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "FHI Value",
      "description": "FHI value for MRIchangeType()"
    },
    "no_ears": {
      "type": "boolean",
      "default": false,
      "title": "Exclude Ears",
      "description": "Do not include ears in the defacing"
    },
    "back_of_head": {
      "type": "boolean",
      "default": false,
      "title": "Include Back of Head",
      "description": "Include back of head in defacing"
    },
    "forehead": {
      "type": "boolean",
      "default": false,
      "title": "Include Forehead",
      "description": "Include forehead in defacing (risks removing brain)"
    },
    "pics": {
      "type": "boolean",
      "default": false,
      "title": "Take Pictures",
      "description": "Take pictures of the defaced result"
    },
    "code": {
      "anyOf": [
        {
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Code Name",
      "description": "Embed code name in pictures"
    },
    "image_convert": {
      "anyOf": [
        {
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "ImageMagick Convert Path",
      "description": "Path to ImageMagick convert binary for pictures"
    },
    "no_post": {
      "type": "boolean",
      "default": false,
      "title": "No Post-processing",
      "description": "Do not make a head surface after defacing"
    },
    "threads": {
      "anyOf": [
        {
          "type": "number"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Threads",
      "description": "Number of threads to use"
    },
    "force": {
      "type": "boolean",
      "default": false,
      "title": "Force Reprocessing",
      "description": "Force reprocessing (only applicable if output directory is used)"
    },
    "output_format": {
      "anyOf": [
        {
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Output Format",
      "description": "Output file format"
    },
    "atlas": {
      "anyOf": [
        {
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Atlas Directory",
      "description": "Directory containing atlas files"
    },
    "expert": {
      "anyOf": [
        {
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Expert Options",
      "description": "Additional expert options"
    },
    "display_no": {
      "anyOf": [
        {
          "type": "number"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Display Number",
      "description": "Xvfb display number for taking pictures"
    },
    "apply_volume": {
      "anyOf": [
        {
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Apply to Another Volume",
      "description": "Apply midface output to a second volume"
    },
    "check_volume": {
      "anyOf": [
        {
          "type": "string",
          "x-styx-type": "file"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Check Defaced Volume",
      "description": "Volume to check if defaced"
    },
    "check_output_file": {
      "anyOf": [
        {
          "type": "string",
          "x-styx-type": "file"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Check Output File",
      "description": "Optional output file for check result"
    }
  },
  "additionalProperties": false,
  "required": [
    "input_volume",
    "output_volume"
  ]
}