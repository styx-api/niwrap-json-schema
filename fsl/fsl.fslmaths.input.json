{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "fslmaths",
  "description": "FSL utility for image arithmetic, statistics, and mathematical operations",
  "type": "object",
  "properties": {
    "@type": {
      "const": "fsl/fslmaths"
    },
    "datatype_internal": {
      "anyOf": [
        {
          "type": "string",
          "enum": [
            "char",
            "short",
            "int",
            "float",
            "double",
            "input"
          ]
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Internal datatype",
      "description": "Datatype used internally for calculations"
    },
    "input_files": {
      "type": "array",
      "items": {
        "type": "string",
        "x-styx-type": "file"
      },
      "title": "Input images",
      "description": "Input images for processing"
    },
    "operations": {
      "type": "array",
      "items": {
        "anyOf": [
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_add"
              },
              "add": {
                "type": "number",
                "title": "Add",
                "description": "Add following input to current image"
              }
            },
            "additionalProperties": false,
            "title": "Add",
            "description": "Add following input to current image",
            "required": [
              "@type",
              "add"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_sub"
              },
              "sub": {
                "type": "number",
                "title": "Subtract",
                "description": "Subtract following input from current image"
              }
            },
            "additionalProperties": false,
            "title": "Subtract",
            "description": "Subtract following input from current image",
            "required": [
              "@type",
              "sub"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_mul"
              },
              "mul": {
                "anyOf": [
                  {
                    "type": "object",
                    "properties": {
                      "@type": {
                        "const": "mul_value"
                      },
                      "value": {
                        "type": "number",
                        "title": "Value"
                      }
                    },
                    "additionalProperties": false,
                    "title": "Multiply by value",
                    "required": [
                      "@type",
                      "value"
                    ]
                  },
                  {
                    "type": "object",
                    "properties": {
                      "@type": {
                        "const": "mul_image"
                      },
                      "image": {
                        "type": "string",
                        "x-styx-type": "file",
                        "title": "Image"
                      }
                    },
                    "additionalProperties": false,
                    "title": "Multiply by image",
                    "required": [
                      "@type",
                      "image"
                    ]
                  }
                ],
                "title": "Multiply",
                "description": "Multiply current image by following input (a number or an image)"
              }
            },
            "additionalProperties": false,
            "title": "Multiply",
            "description": "Multiply current image by following input",
            "required": [
              "@type",
              "mul"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_div"
              },
              "div": {
                "type": "number",
                "title": "Divide",
                "description": "Divide current image by following input"
              }
            },
            "additionalProperties": false,
            "title": "Divide",
            "description": "Divide current image by following input",
            "required": [
              "@type",
              "div"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_rem"
              },
              "rem": {
                "type": "number",
                "title": "Modulus remainder",
                "description": "Modulus remainder - divide current image by following input and take remainder"
              }
            },
            "additionalProperties": false,
            "title": "Modulus remainder",
            "description": "Modulus remainder - divide current image by following input and take remainder",
            "required": [
              "@type",
              "rem"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_mas"
              },
              "mas": {
                "type": "string",
                "x-styx-type": "file",
                "title": "Mask",
                "description": "Use (following image>0) to mask current image"
              }
            },
            "additionalProperties": false,
            "title": "Mask",
            "description": "Use (following image>0) to mask current image",
            "required": [
              "@type",
              "mas"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_thr"
              },
              "thr": {
                "type": "number",
                "title": "Threshold",
                "description": "Use following number to threshold current image (zero anything below the number)"
              }
            },
            "additionalProperties": false,
            "title": "Threshold",
            "description": "Use following number to threshold current image (zero anything below the number)",
            "required": [
              "@type",
              "thr"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_thrp"
              },
              "thrp": {
                "type": "number",
                "minimum": 0,
                "maximum": 100,
                "title": "Threshold percentage",
                "description": "Use following percentage (0-100) of ROBUST RANGE to threshold current image (zero anything below the number)"
              }
            },
            "additionalProperties": false,
            "title": "Threshold percentage",
            "description": "Use following percentage (0-100) of ROBUST RANGE to threshold current image (zero anything below the number)",
            "required": [
              "@type",
              "thrp"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_thrP"
              },
              "thrP": {
                "type": "number",
                "minimum": 0,
                "maximum": 100,
                "title": "Threshold percentage of non-zero voxels",
                "description": "Use following percentage (0-100) of ROBUST RANGE of non-zero voxels and threshold below"
              }
            },
            "additionalProperties": false,
            "title": "Threshold percentage of non-zero voxels",
            "description": "Use following percentage (0-100) of ROBUST RANGE of non-zero voxels and threshold below",
            "required": [
              "@type",
              "thrP"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_uthr"
              },
              "uthr": {
                "type": "number",
                "title": "Upper threshold",
                "description": "Use following number to upper-threshold current image (zero anything above the number)"
              }
            },
            "additionalProperties": false,
            "title": "Upper threshold",
            "description": "Use following number to upper-threshold current image (zero anything above the number)",
            "required": [
              "@type",
              "uthr"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_uthrp"
              },
              "uthrp": {
                "type": "number",
                "minimum": 0,
                "maximum": 100,
                "title": "Upper threshold percentage",
                "description": "Use following percentage (0-100) of ROBUST RANGE to upper-threshold current image (zero anything above the number)"
              }
            },
            "additionalProperties": false,
            "title": "Upper threshold percentage",
            "description": "Use following percentage (0-100) of ROBUST RANGE to upper-threshold current image (zero anything above the number)",
            "required": [
              "@type",
              "uthrp"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_uthrP"
              },
              "uthrP": {
                "type": "number",
                "minimum": 0,
                "maximum": 100,
                "title": "Upper threshold percentage of non-zero voxels",
                "description": "Use following percentage (0-100) of ROBUST RANGE of non-zero voxels and threshold above"
              }
            },
            "additionalProperties": false,
            "title": "Upper threshold percentage of non-zero voxels",
            "description": "Use following percentage (0-100) of ROBUST RANGE of non-zero voxels and threshold above",
            "required": [
              "@type",
              "uthrP"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_max"
              },
              "max": {
                "type": "number",
                "title": "Maximum",
                "description": "Take maximum of following input and current image"
              }
            },
            "additionalProperties": false,
            "title": "Maximum",
            "description": "Take maximum of following input and current image",
            "required": [
              "@type",
              "max"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_min"
              },
              "min": {
                "type": "number",
                "title": "Minimum",
                "description": "Take minimum of following input and current image"
              }
            },
            "additionalProperties": false,
            "title": "Minimum",
            "description": "Take minimum of following input and current image",
            "required": [
              "@type",
              "min"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_seed"
              },
              "seed": {
                "type": "number",
                "title": "Seed",
                "description": "Seed random number generator with following number"
              }
            },
            "additionalProperties": false,
            "title": "Seed",
            "description": "Seed random number generator with following number",
            "required": [
              "@type",
              "seed"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_restart"
              },
              "restart": {
                "type": "string",
                "x-styx-type": "file",
                "title": "Restart",
                "description": "Replace the current image with input for future processing operations"
              }
            },
            "additionalProperties": false,
            "title": "Restart",
            "description": "Replace the current image with input for future processing operations",
            "required": [
              "@type",
              "restart"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_save"
              },
              "save": {
                "type": "boolean",
                "default": false,
                "title": "Save",
                "description": "Save the current working image to the input filename"
              }
            },
            "additionalProperties": false,
            "title": "Save",
            "description": "Save the current working image to the input filename",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_exp"
              },
              "exp": {
                "type": "boolean",
                "default": false,
                "title": "Exponential",
                "description": "Exponential"
              }
            },
            "additionalProperties": false,
            "title": "Exponential",
            "description": "Exponential",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_log"
              },
              "log": {
                "type": "boolean",
                "default": false,
                "title": "Natural logarithm",
                "description": "Natural logarithm"
              }
            },
            "additionalProperties": false,
            "title": "Natural logarithm",
            "description": "Natural logarithm",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_sin"
              },
              "sin": {
                "type": "boolean",
                "default": false,
                "title": "Sine",
                "description": "Sine function"
              }
            },
            "additionalProperties": false,
            "title": "Sine",
            "description": "Sine function",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_cos"
              },
              "cos": {
                "type": "boolean",
                "default": false,
                "title": "Cosine",
                "description": "Cosine function"
              }
            },
            "additionalProperties": false,
            "title": "Cosine",
            "description": "Cosine function",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_tan"
              },
              "tan": {
                "type": "boolean",
                "default": false,
                "title": "Tangent",
                "description": "Tangent function"
              }
            },
            "additionalProperties": false,
            "title": "Tangent",
            "description": "Tangent function",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_asin"
              },
              "asin": {
                "type": "boolean",
                "default": false,
                "title": "Arc sine",
                "description": "Arc sine function"
              }
            },
            "additionalProperties": false,
            "title": "Arc sine",
            "description": "Arc sine function",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_acos"
              },
              "acos": {
                "type": "boolean",
                "default": false,
                "title": "Arc cosine",
                "description": "Arc cosine function"
              }
            },
            "additionalProperties": false,
            "title": "Arc cosine",
            "description": "Arc cosine function",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_atan"
              },
              "atan": {
                "type": "boolean",
                "default": false,
                "title": "Arc tangent",
                "description": "Arc tangent function"
              }
            },
            "additionalProperties": false,
            "title": "Arc tangent",
            "description": "Arc tangent function",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_sqr"
              },
              "sqr": {
                "type": "boolean",
                "default": false,
                "title": "Square",
                "description": "Square"
              }
            },
            "additionalProperties": false,
            "title": "Square",
            "description": "Square",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_sqrt"
              },
              "sqrt": {
                "type": "boolean",
                "default": false,
                "title": "Square root",
                "description": "Square root"
              }
            },
            "additionalProperties": false,
            "title": "Square root",
            "description": "Square root",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_recip"
              },
              "recip": {
                "type": "boolean",
                "default": false,
                "title": "Reciprocal",
                "description": "Reciprocal (1/current image)"
              }
            },
            "additionalProperties": false,
            "title": "Reciprocal",
            "description": "Reciprocal (1/current image)",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_abs"
              },
              "abs": {
                "type": "boolean",
                "default": false,
                "title": "Absolute value",
                "description": "Absolute value"
              }
            },
            "additionalProperties": false,
            "title": "Absolute value",
            "description": "Absolute value",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_bin"
              },
              "bin": {
                "type": "boolean",
                "default": false,
                "title": "Binarise",
                "description": "Use (current image>0) to binarise"
              }
            },
            "additionalProperties": false,
            "title": "Binarise",
            "description": "Use (current image>0) to binarise",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_binv"
              },
              "binv": {
                "type": "boolean",
                "default": false,
                "title": "Binarise and invert",
                "description": "Binarise and invert (binarisation and logical inversion)"
              }
            },
            "additionalProperties": false,
            "title": "Binarise and invert",
            "description": "Binarise and invert (binarisation and logical inversion)",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_fillh"
              },
              "fillh": {
                "type": "boolean",
                "default": false,
                "title": "Fill holes",
                "description": "Fill holes in a binary mask (holes are internal - i.e. do not touch the edge of the FOV)"
              }
            },
            "additionalProperties": false,
            "title": "Fill holes",
            "description": "Fill holes in a binary mask (holes are internal - i.e. do not touch the edge of the FOV)",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_fillh26"
              },
              "fillh26": {
                "type": "boolean",
                "default": false,
                "title": "Fill holes using 26 connectivity",
                "description": "Fill holes using 26 connectivity"
              }
            },
            "additionalProperties": false,
            "title": "Fill holes using 26 connectivity",
            "description": "Fill holes using 26 connectivity",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_index"
              },
              "index": {
                "type": "boolean",
                "default": false,
                "title": "Index",
                "description": "Replace each nonzero voxel with a unique (subject to wrapping) index number"
              }
            },
            "additionalProperties": false,
            "title": "Index",
            "description": "Replace each nonzero voxel with a unique (subject to wrapping) index number",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_grid"
              },
              "grid": {
                "type": "array",
                "items": {
                  "type": "number"
                },
                "title": "Grid",
                "description": "Add a 3D grid of intensity <value> with grid spacing <spacing>"
              }
            },
            "additionalProperties": false,
            "title": "Grid",
            "description": "Add a 3D grid of intensity <value> with grid spacing <spacing>",
            "required": [
              "@type",
              "grid"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_edge"
              },
              "edge": {
                "type": "boolean",
                "default": false,
                "title": "Edge strength",
                "description": "Edge strength"
              }
            },
            "additionalProperties": false,
            "title": "Edge strength",
            "description": "Edge strength",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_tfce"
              },
              "tfce": {
                "type": "array",
                "items": {
                  "type": "number"
                },
                "title": "Enhance with TFCE",
                "description": "Enhance with TFCE, e.g. -tfce 2 0.5 6 (maybe change 6 to 26 for skeletons)"
              }
            },
            "additionalProperties": false,
            "title": "Enhance with TFCE",
            "description": "Enhance with TFCE, e.g. -tfce 2 0.5 6 (maybe change 6 to 26 for skeletons)",
            "required": [
              "@type",
              "tfce"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_tfceS"
              },
              "tfceS": {
                "type": "array",
                "items": {
                  "type": "number"
                },
                "title": "Show support area for voxel",
                "description": "Show support area for voxel (X,Y,Z)"
              }
            },
            "additionalProperties": false,
            "title": "Show support area for voxel",
            "description": "Show support area for voxel (X,Y,Z)",
            "required": [
              "@type",
              "tfceS"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_nan"
              },
              "nan": {
                "type": "boolean",
                "default": false,
                "title": "Replace NaNs",
                "description": "Replace NaNs (improper numbers) with 0"
              }
            },
            "additionalProperties": false,
            "title": "Replace NaNs",
            "description": "Replace NaNs (improper numbers) with 0",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_nanm"
              },
              "nanm": {
                "type": "boolean",
                "default": false,
                "title": "Make NaN mask",
                "description": "Make NaN (improper number) mask with 1 for NaN voxels, 0 otherwise"
              }
            },
            "additionalProperties": false,
            "title": "Make NaN mask",
            "description": "Make NaN (improper number) mask with 1 for NaN voxels, 0 otherwise",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_rand"
              },
              "rand": {
                "type": "boolean",
                "default": false,
                "title": "Add uniform noise",
                "description": "Add uniform noise (range 0:1)"
              }
            },
            "additionalProperties": false,
            "title": "Add uniform noise",
            "description": "Add uniform noise (range 0:1)",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_randn"
              },
              "randn": {
                "type": "boolean",
                "default": false,
                "title": "Add Gaussian noise",
                "description": "Add Gaussian noise (mean=0 sigma=1)"
              }
            },
            "additionalProperties": false,
            "title": "Add Gaussian noise",
            "description": "Add Gaussian noise (mean=0 sigma=1)",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_inm"
              },
              "inm": {
                "type": "number",
                "title": "Intensity normalisation",
                "description": "Intensity normalisation (per 3D volume mean)"
              }
            },
            "additionalProperties": false,
            "title": "Intensity normalisation",
            "description": "Intensity normalisation (per 3D volume mean)",
            "required": [
              "@type",
              "inm"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_ing"
              },
              "ing": {
                "type": "number",
                "title": "Intensity normalisation, global 4D mean",
                "description": "Intensity normalisation, global 4D mean"
              }
            },
            "additionalProperties": false,
            "title": "Intensity normalisation, global 4D mean",
            "description": "Intensity normalisation, global 4D mean",
            "required": [
              "@type",
              "ing"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_range"
              },
              "range": {
                "type": "boolean",
                "default": false,
                "title": "Set output calmin/max to full data range",
                "description": "Set the output calmin/max to full data range"
              }
            },
            "additionalProperties": false,
            "title": "Set output calmin/max to full data range",
            "description": "Set the output calmin/max to full data range",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_tensor_decomp"
              },
              "tensor_decomp": {
                "type": "boolean",
                "default": false,
                "title": "Tensor decomposition",
                "description": "Convert a 4D (6-timepoint) tensor image into L1,2,3,FA,MD,MO,V1,2,3 (remaining image in pipeline is FA)"
              }
            },
            "additionalProperties": false,
            "title": "Tensor decomposition",
            "description": "Convert a 4D (6-timepoint) tensor image into L1,2,3,FA,MD,MO,V1,2,3 (remaining image in pipeline is FA)",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_kernel_3D"
              }
            },
            "additionalProperties": false,
            "title": "3D kernel",
            "description": "3x3x3 box centered on target voxel (set as default kernel)",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_kernel_2D"
              }
            },
            "additionalProperties": false,
            "title": "2D kernel",
            "description": "3x3x1 box centered on target voxel",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_kernel_box"
              },
              "kernel_box": {
                "type": "number",
                "title": "Box kernel",
                "description": "All voxels in a cube of width <size> mm centered on target voxel"
              }
            },
            "additionalProperties": false,
            "title": "Box kernel",
            "description": "All voxels in a cube of width <size> mm centered on target voxel",
            "required": [
              "@type",
              "kernel_box"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_kernel_boxv"
              },
              "kernel_boxv": {
                "type": "number",
                "title": "Box kernel (voxels)",
                "description": "All voxels in a cube of width <size> voxels centered on target voxel"
              }
            },
            "additionalProperties": false,
            "title": "Box kernel (voxels)",
            "description": "All voxels in a cube of width <size> voxels centered on target voxel",
            "required": [
              "@type",
              "kernel_boxv"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_kernel_boxv3"
              },
              "kernel_boxv3": {
                "type": "array",
                "items": {
                  "type": "number"
                },
                "minItems": 3,
                "maxItems": 3,
                "title": "Box kernel (3D voxels)",
                "description": "All voxels in a cuboid of dimensions X x Y x Z centered on target voxel"
              }
            },
            "additionalProperties": false,
            "title": "Box kernel (3D voxels)",
            "description": "All voxels in a cuboid of dimensions X x Y x Z centered on target voxel",
            "required": [
              "@type",
              "kernel_boxv3"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_kernel_gauss"
              },
              "kernel_gauss": {
                "type": "number",
                "title": "Gaussian kernel",
                "description": "Gaussian kernel (sigma in mm, not voxels)"
              }
            },
            "additionalProperties": false,
            "title": "Gaussian kernel",
            "description": "Gaussian kernel (sigma in mm, not voxels)",
            "required": [
              "@type",
              "kernel_gauss"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_kernel_sphere"
              },
              "kernel_sphere": {
                "type": "number",
                "title": "Sphere kernel",
                "description": "All voxels in a sphere of radius <size> mm centered on target voxel"
              }
            },
            "additionalProperties": false,
            "title": "Sphere kernel",
            "description": "All voxels in a sphere of radius <size> mm centered on target voxel",
            "required": [
              "@type",
              "kernel_sphere"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_kernel_file"
              },
              "kernel_file": {
                "type": "string",
                "x-styx-type": "file",
                "title": "External file kernel",
                "description": "Use external file as kernel"
              }
            },
            "additionalProperties": false,
            "title": "External file kernel",
            "description": "Use external file as kernel",
            "required": [
              "@type",
              "kernel_file"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_dilM"
              },
              "dilM": {
                "type": "boolean",
                "default": false,
                "title": "Mean dilation",
                "description": "Mean Dilation of non-zero voxels"
              }
            },
            "additionalProperties": false,
            "title": "Mean dilation",
            "description": "Mean Dilation of non-zero voxels",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_dilD"
              },
              "dilD": {
                "type": "boolean",
                "default": false,
                "title": "Modal dilation",
                "description": "Modal Dilation of non-zero voxels"
              }
            },
            "additionalProperties": false,
            "title": "Modal dilation",
            "description": "Modal Dilation of non-zero voxels",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_dilF"
              },
              "dilF": {
                "type": "boolean",
                "default": false,
                "title": "Maximum filtering",
                "description": "Maximum filtering of all voxels"
              }
            },
            "additionalProperties": false,
            "title": "Maximum filtering",
            "description": "Maximum filtering of all voxels",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_dilall"
              },
              "dilall": {
                "type": "boolean",
                "default": false,
                "title": "Dilate all",
                "description": "Apply -dilM repeatedly until the entire FOV is covered"
              }
            },
            "additionalProperties": false,
            "title": "Dilate all",
            "description": "Apply -dilM repeatedly until the entire FOV is covered",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_ero"
              },
              "ero": {
                "type": "boolean",
                "default": false,
                "title": "Erode",
                "description": "Erode by zeroing non-zero voxels when zero voxels found in kernel"
              }
            },
            "additionalProperties": false,
            "title": "Erode",
            "description": "Erode by zeroing non-zero voxels when zero voxels found in kernel",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_eroF"
              },
              "eroF": {
                "type": "boolean",
                "default": false,
                "title": "Minimum filtering",
                "description": "Minimum filtering of all voxels"
              }
            },
            "additionalProperties": false,
            "title": "Minimum filtering",
            "description": "Minimum filtering of all voxels",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_fmedian"
              },
              "fmedian": {
                "type": "boolean",
                "default": false,
                "title": "Median filtering",
                "description": "Median Filtering"
              }
            },
            "additionalProperties": false,
            "title": "Median filtering",
            "description": "Median Filtering",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_fmean"
              },
              "fmean": {
                "type": "boolean",
                "default": false,
                "title": "Mean filtering",
                "description": "Mean filtering, kernel weighted (conventionally used with gauss kernel)"
              }
            },
            "additionalProperties": false,
            "title": "Mean filtering",
            "description": "Mean filtering, kernel weighted (conventionally used with gauss kernel)",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_fmeanu"
              },
              "fmeanu": {
                "type": "boolean",
                "default": false,
                "title": "Mean filtering un-normalised",
                "description": "Mean filtering, kernel weighted, un-normalised (gives edge effects)"
              }
            },
            "additionalProperties": false,
            "title": "Mean filtering un-normalised",
            "description": "Mean filtering, kernel weighted, un-normalised (gives edge effects)",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_s"
              },
              "s": {
                "type": "number",
                "title": "Gaussian kernel filtering",
                "description": "Create a gauss kernel of sigma mm and perform mean filtering"
              }
            },
            "additionalProperties": false,
            "title": "Gaussian kernel filtering",
            "description": "Create a gauss kernel of sigma mm and perform mean filtering",
            "required": [
              "@type",
              "s"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_subsamp2"
              },
              "subsamp2": {
                "type": "boolean",
                "default": false,
                "title": "Downsample by factor of 2",
                "description": "Downsamples image by a factor of 2 (keeping new voxels centred on old)"
              }
            },
            "additionalProperties": false,
            "title": "Downsample by factor of 2",
            "description": "Downsamples image by a factor of 2 (keeping new voxels centred on old)",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_subsamp2offc"
              },
              "subsamp2offc": {
                "type": "boolean",
                "default": false,
                "title": "Downsample by factor of 2 (non-centred)",
                "description": "Downsamples image by a factor of 2 (non-centred)"
              }
            },
            "additionalProperties": false,
            "title": "Downsample by factor of 2 (non-centred)",
            "description": "Downsamples image by a factor of 2 (non-centred)",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_Tmean"
              },
              "Tmean": {
                "type": "boolean",
                "default": false,
                "title": "Mean across time",
                "description": "Mean across time"
              }
            },
            "additionalProperties": false,
            "title": "Mean across time",
            "description": "Mean across time",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_Xmean"
              },
              "Xmean": {
                "type": "boolean",
                "default": false,
                "title": "Mean across X axis",
                "description": "Mean across X axis"
              }
            },
            "additionalProperties": false,
            "title": "Mean across X axis",
            "description": "Mean across X axis",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_Ymean"
              },
              "Ymean": {
                "type": "boolean",
                "default": false,
                "title": "Mean across Y axis",
                "description": "Mean across Y axis"
              }
            },
            "additionalProperties": false,
            "title": "Mean across Y axis",
            "description": "Mean across Y axis",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_Zmean"
              },
              "Zmean": {
                "type": "boolean",
                "default": false,
                "title": "Mean across Z axis",
                "description": "Mean across Z axis"
              }
            },
            "additionalProperties": false,
            "title": "Mean across Z axis",
            "description": "Mean across Z axis",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_Tstd"
              },
              "Tstd": {
                "type": "boolean",
                "default": false,
                "title": "Standard deviation across time",
                "description": "Standard deviation across time"
              }
            },
            "additionalProperties": false,
            "title": "Standard deviation across time",
            "description": "Standard deviation across time",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_Xstd"
              },
              "Xstd": {
                "type": "boolean",
                "default": false,
                "title": "Standard deviation across X axis",
                "description": "Standard deviation across X axis"
              }
            },
            "additionalProperties": false,
            "title": "Standard deviation across X axis",
            "description": "Standard deviation across X axis",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_Ystd"
              },
              "Ystd": {
                "type": "boolean",
                "default": false,
                "title": "Standard deviation across Y axis",
                "description": "Standard deviation across Y axis"
              }
            },
            "additionalProperties": false,
            "title": "Standard deviation across Y axis",
            "description": "Standard deviation across Y axis",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_Zstd"
              },
              "Zstd": {
                "type": "boolean",
                "default": false,
                "title": "Standard deviation across Z axis",
                "description": "Standard deviation across Z axis"
              }
            },
            "additionalProperties": false,
            "title": "Standard deviation across Z axis",
            "description": "Standard deviation across Z axis",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_Tmax"
              },
              "Tmax": {
                "type": "boolean",
                "default": false,
                "title": "Max across time",
                "description": "Max across time"
              }
            },
            "additionalProperties": false,
            "title": "Max across time",
            "description": "Max across time",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_Xmax"
              },
              "Xmax": {
                "type": "boolean",
                "default": false,
                "title": "Max across X axis",
                "description": "Max across X axis"
              }
            },
            "additionalProperties": false,
            "title": "Max across X axis",
            "description": "Max across X axis",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_Ymax"
              },
              "Ymax": {
                "type": "boolean",
                "default": false,
                "title": "Max across Y axis",
                "description": "Max across Y axis"
              }
            },
            "additionalProperties": false,
            "title": "Max across Y axis",
            "description": "Max across Y axis",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_Zmax"
              },
              "Zmax": {
                "type": "boolean",
                "default": false,
                "title": "Max across Z axis",
                "description": "Max across Z axis"
              }
            },
            "additionalProperties": false,
            "title": "Max across Z axis",
            "description": "Max across Z axis",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_Tmaxn"
              },
              "Tmaxn": {
                "type": "boolean",
                "default": false,
                "title": "Time index of max across time",
                "description": "Time index of max across time"
              }
            },
            "additionalProperties": false,
            "title": "Time index of max across time",
            "description": "Time index of max across time",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_Xmaxn"
              },
              "Xmaxn": {
                "type": "boolean",
                "default": false,
                "title": "X index of max across X axis",
                "description": "X index of max across X axis"
              }
            },
            "additionalProperties": false,
            "title": "X index of max across X axis",
            "description": "X index of max across X axis",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_Ymaxn"
              },
              "Ymaxn": {
                "type": "boolean",
                "default": false,
                "title": "Y index of max across Y axis",
                "description": "Y index of max across Y axis"
              }
            },
            "additionalProperties": false,
            "title": "Y index of max across Y axis",
            "description": "Y index of max across Y axis",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_Zmaxn"
              },
              "Zmaxn": {
                "type": "boolean",
                "default": false,
                "title": "Z index of max across Z axis",
                "description": "Z index of max across Z axis"
              }
            },
            "additionalProperties": false,
            "title": "Z index of max across Z axis",
            "description": "Z index of max across Z axis",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_Tmin"
              },
              "Tmin": {
                "type": "boolean",
                "default": false,
                "title": "Min across time",
                "description": "Min across time"
              }
            },
            "additionalProperties": false,
            "title": "Min across time",
            "description": "Min across time",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_Xmin"
              },
              "Xmin": {
                "type": "boolean",
                "default": false,
                "title": "Min across X axis",
                "description": "Min across X axis"
              }
            },
            "additionalProperties": false,
            "title": "Min across X axis",
            "description": "Min across X axis",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_Ymin"
              },
              "Ymin": {
                "type": "boolean",
                "default": false,
                "title": "Min across Y axis",
                "description": "Min across Y axis"
              }
            },
            "additionalProperties": false,
            "title": "Min across Y axis",
            "description": "Min across Y axis",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_Zmin"
              },
              "Zmin": {
                "type": "boolean",
                "default": false,
                "title": "Min across Z axis",
                "description": "Min across Z axis"
              }
            },
            "additionalProperties": false,
            "title": "Min across Z axis",
            "description": "Min across Z axis",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_Tmedian"
              },
              "Tmedian": {
                "type": "boolean",
                "default": false,
                "title": "Median across time",
                "description": "Median across time"
              }
            },
            "additionalProperties": false,
            "title": "Median across time",
            "description": "Median across time",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_Xmedian"
              },
              "Xmedian": {
                "type": "boolean",
                "default": false,
                "title": "Median across X axis",
                "description": "Median across X axis"
              }
            },
            "additionalProperties": false,
            "title": "Median across X axis",
            "description": "Median across X axis",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_Ymedian"
              },
              "Ymedian": {
                "type": "boolean",
                "default": false,
                "title": "Median across Y axis",
                "description": "Median across Y axis"
              }
            },
            "additionalProperties": false,
            "title": "Median across Y axis",
            "description": "Median across Y axis",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_Zmedian"
              },
              "Zmedian": {
                "type": "boolean",
                "default": false,
                "title": "Median across Z axis",
                "description": "Median across Z axis"
              }
            },
            "additionalProperties": false,
            "title": "Median across Z axis",
            "description": "Median across Z axis",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_Tperc"
              },
              "Tperc": {
                "type": "number",
                "minimum": 0,
                "maximum": 100,
                "title": "Percentile across time",
                "description": "Nth percentile (0-100) of FULL RANGE across time"
              }
            },
            "additionalProperties": false,
            "title": "Percentile across time",
            "description": "Nth percentile (0-100) of FULL RANGE across time",
            "required": [
              "@type",
              "Tperc"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_Xperc"
              },
              "Xperc": {
                "type": "number",
                "minimum": 0,
                "maximum": 100,
                "title": "Percentile across X axis",
                "description": "Nth percentile (0-100) of FULL RANGE across X axis"
              }
            },
            "additionalProperties": false,
            "title": "Percentile across X axis",
            "description": "Nth percentile (0-100) of FULL RANGE across X axis",
            "required": [
              "@type",
              "Xperc"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_Yperc"
              },
              "Yperc": {
                "type": "number",
                "minimum": 0,
                "maximum": 100,
                "title": "Percentile across Y axis",
                "description": "Nth percentile (0-100) of FULL RANGE across Y axis"
              }
            },
            "additionalProperties": false,
            "title": "Percentile across Y axis",
            "description": "Nth percentile (0-100) of FULL RANGE across Y axis",
            "required": [
              "@type",
              "Yperc"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_Zperc"
              },
              "Zperc": {
                "type": "number",
                "minimum": 0,
                "maximum": 100,
                "title": "Percentile across Z axis",
                "description": "Nth percentile (0-100) of FULL RANGE across Z axis"
              }
            },
            "additionalProperties": false,
            "title": "Percentile across Z axis",
            "description": "Nth percentile (0-100) of FULL RANGE across Z axis",
            "required": [
              "@type",
              "Zperc"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_Tar1"
              },
              "Tar1": {
                "type": "boolean",
                "default": false,
                "title": "Temporal AR(1) coefficient",
                "description": "Temporal AR(1) coefficient (use -odt float and probably demean first)"
              }
            },
            "additionalProperties": false,
            "title": "Temporal AR(1) coefficient",
            "description": "Temporal AR(1) coefficient (use -odt float and probably demean first)",
            "required": [
              "@type"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_roi"
              },
              "roi": {
                "type": "array",
                "items": {
                  "type": "number"
                },
                "minItems": 6,
                "maxItems": 6,
                "title": "Zero outside ROI",
                "description": "<xmin> <xsize> <ymin> <ysize> <zmin> <zsize> <tmin> <tsize>. Zero outside roi (using voxel coordinates). Inputting -1 for a size will set it to the full image extent for that dimension."
              }
            },
            "additionalProperties": false,
            "title": "Zero outside ROI",
            "description": "<xmin> <xsize> <ymin> <ysize> <zmin> <zsize> <tmin> <tsize>. Zero outside roi (using voxel coordinates). Inputting -1 for a size will set it to the full image extent for that dimension.",
            "required": [
              "@type",
              "roi"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_bptf"
              },
              "bptf": {
                "type": "array",
                "items": {
                  "type": "number"
                },
                "minItems": 2,
                "maxItems": 2,
                "title": "Bandpass temporal filtering",
                "description": "<lowpass> <highpass>. Bandpass temporal filtering (use -odt float and probably demean first)"
              }
            },
            "additionalProperties": false,
            "title": "Bandpass temporal filtering",
            "description": "<lowpass> <highpass>. Bandpass temporal filtering (use -odt float and probably demean first)",
            "required": [
              "@type",
              "bptf"
            ]
          },
          {
            "type": "object",
            "properties": {
              "@type": {
                "const": "operation_roc"
              },
              "roc": {
                "type": "array",
                "items": {
                  "type": "number"
                },
                "title": "ROC analysis",
                "description": "<threshold> <output>. ROC analysis"
              }
            },
            "additionalProperties": false,
            "title": "ROC analysis",
            "description": "<threshold> <output>. ROC analysis",
            "required": [
              "@type",
              "roc"
            ]
          }
        ]
      },
      "title": "Operations",
      "description": "Operations to perform on input images"
    },
    "output": {
      "type": "string",
      "title": "Output",
      "description": "Output image file"
    },
    "output_datatype": {
      "anyOf": [
        {
          "type": "string",
          "enum": [
            "char",
            "short",
            "int",
            "float",
            "double",
            "input"
          ]
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Output datatype",
      "description": "Datatype used for the output image"
    }
  },
  "additionalProperties": false,
  "required": [
    "input_files",
    "operations",
    "output",
    "@type"
  ]
}