{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "fsl_regfilt",
  "description": "Data de-noising by regressing out part of a design matrix using simple OLS regression on 4D images",
  "type": "object",
  "properties": {
    "@type": {
      "const": "fsl.fsl_regfilt"
    },
    "infile": {
      "type": "string",
      "x-styx-type": "file",
      "title": "Input file",
      "description": "Input file name (4D image)"
    },
    "designfile": {
      "type": "string",
      "x-styx-type": "file",
      "title": "Design file",
      "description": "File name of the matrix with time courses (e.g. GLM design or MELODIC mixing matrix)"
    },
    "outfile": {
      "type": "string",
      "title": "Output file",
      "description": "Output file name for the filtered data"
    },
    "maskfile": {
      "anyOf": [
        {
          "type": "string",
          "x-styx-type": "file"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Mask file",
      "description": "Mask image file name"
    },
    "filter": {
      "anyOf": [
        {
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Filter",
      "description": "Filter out part of the regression model, e.g., -f \"1,2,3\""
    },
    "freq_filter_flag": {
      "type": "boolean",
      "default": false,
      "title": "Frequency filter flag",
      "description": "Filter out components based on high vs. low frequency content"
    },
    "freq_ic_flag": {
      "type": "boolean",
      "default": false,
      "title": "Frequency IC Z-stats filtering flag",
      "description": "Switch off IC Z-stats filtering as part of frequency filtering"
    },
    "freq_ic_smooth": {
      "anyOf": [
        {
          "type": "number"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Frequency IC Z-stats smoothing width",
      "description": "Smoothing width for IC Z-stats filtering as part of frequency filtering"
    },
    "fthresh": {
      "anyOf": [
        {
          "type": "number"
        },
        {
          "type": "null"
        }
      ],
      "default": 0.15,
      "title": "Frequency threshold ratio",
      "description": "Frequency threshold ratio; default: 0.15"
    },
    "fthresh2": {
      "anyOf": [
        {
          "type": "number"
        },
        {
          "type": "null"
        }
      ],
      "default": 0.02,
      "title": "Frequency filter score threshold",
      "description": "Frequency filter score threshold; default: 0.02"
    },
    "vn_flag": {
      "type": "boolean",
      "default": false,
      "title": "Variance-normalisation flag",
      "description": "Perform variance-normalisation on data"
    },
    "verbose_flag": {
      "type": "boolean",
      "default": false,
      "title": "Verbose flag",
      "description": "Switch on diagnostic messages"
    },
    "aggressive_flag": {
      "type": "boolean",
      "default": false,
      "title": "Aggressive filtering flag",
      "description": "Switch on aggressive filtering (full instead of partial regression)"
    },
    "help_flag": {
      "type": "boolean",
      "default": false,
      "title": "Help flag",
      "description": "Display help text"
    },
    "out_data": {
      "anyOf": [
        {
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Output pre-processed data",
      "description": "Output file name for pre-processed data (prior to denoising)"
    },
    "out_mix": {
      "anyOf": [
        {
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Output new mixing matrix",
      "description": "Output file name for new mixing matrix"
    },
    "out_vnscales": {
      "anyOf": [
        {
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Output variance normalisation scales",
      "description": "Output file name for scaling factors from variance normalisation"
    }
  },
  "additionalProperties": false,
  "required": [
    "infile",
    "designfile",
    "outfile"
  ]
}